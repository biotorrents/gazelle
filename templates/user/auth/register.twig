{% extends "base.twig" %}

{% block content %}

<h2>Register for a new account</h2>

{% if response is not null %}
<p class="error">
    {{ response }}
</p>
{% endif %}

{% if emailSent is not null %}
<p class="info">
    {# https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html#account-creation #}
    A link to activate your account has been emailed to the address provided.
</p>


{% else %}


{# start the registration form itself #}
<form name="register" id="register" method="post" autocomplete="off">
    {{ form_token(query.server.REQUEST_URI) }}

    {# authKey #}
    {% if user.AuthKey is defined %}
    <input type="hidden" name="authKey" id="authKey" value="{{ user.AuthKey }}" />
    {% endif %}

    {# invite #}
    {% if invite is defined %}
    <input type="hidden" name="invite" id="invite" value="{{ invite }}" />
    {% endif %}

    {# username #}
    {% if post.username is defined %}
    <input type="text" name="username" id="username" placeholder="Username" value="{{ post.username }}" required />
    {% else %}
    <input type="text" name="username" id="username" placeholder="Username" required />
    {% endif %}

    {# email #}
    {% if post.email is defined %}
    <input type="email" name="email" id="email" placeholder="Email address" value="{{ post.email }}" required />
    {% else %}
    <input type="email" name="email" id="email" placeholder="Email address" required />
    {% endif %}

    {# passphrase #}
    <input type="password" name="passphrase" id="passphrase" placeholder="Passphrase" minlength="15" required />

    {# confirmPassphrase #}
    <input type="password" name="confirmPassphrase" id="confirmPassphrase" placeholder="Confirm passphrase"
        minlength="15" required />

    <ul>
        <li>
            {# isAdult #}
            {% if post.isAdult is defined %}
            <input type="checkbox" name="isAdult" id="isAdult" value="true" checked />
            {% else %}
            <input type="checkbox" name="isAdult" id="isAdult" value="true" />
            {% endif %}
            <label for="isAdult">I'm 18 years or older</label>
        </li>

        <li>
            {# privacyConsent #}
            {% if post.privacyConsent is defined %}
            <input type="checkbox" name="privacyConsent" id="privacyConsent" value="true" checked />
            {% else %}
            <input type="checkbox" name="privacyConsent" id="privacyConsent" value="true" />
            {% endif %}
            <label for="privacyConsent">I consent to the <a href="/privacy">privacy policy</a></label>
        </li>

        <li>
            {# ruleWikiPledge #}
            {% if post.ruleWikiPledge is defined %}
            <input type="checkbox" name="ruleWikiPledge" id="ruleWikiPledge" value="true" checked />
            {% else %}
            <input type="checkbox" name="ruleWikiPledge" id="ruleWikiPledge" value="true" />
            {% endif %}
            <label for="ruleWikiPledge">I'll read the site rules and wiki</label>
        </li>
    </ul>

    {# submit #}
    <input type="submit" name="submit" id="submit" value="Create my account" class="button-primary" />

</form>

{% endif %} {# if !emailSent #}
{% endblock %}